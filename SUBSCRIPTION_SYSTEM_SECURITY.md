# –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –ø–æ–¥–ø–∏—Å–æ–∫ CleanHouse API

## –û–±–∑–æ—Ä

–°–∏—Å—Ç–µ–º–∞ –ø–æ–¥–ø–∏—Å–æ–∫ –±—ã–ª–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∞–Ω–∞ —Å —É—á–µ—Ç–æ–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –∑–∞—â–∏—Ç—ã –æ—Ç –≤—Å–µ—Ö –≤—ã—è–≤–ª–µ–Ω–Ω—ã—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π. –ù–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –Ω–∞–¥–µ–∂–Ω—É—é –∑–∞—â–∏—Ç—É —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –∏ –∫–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞.

## üõ°Ô∏è –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### 1. –í–∞–ª–∏–¥–∞—Ü–∏—è —Ü–µ–Ω –∏ —Ç–∏–ø–æ–≤ –ø–æ–¥–ø–∏—Å–æ–∫

**–ü—Ä–æ–±–ª–µ–º–∞:** –ö–ª–∏–µ–Ω—Ç –º–æ–≥ —É–∫–∞–∑–∞—Ç—å –ª—é–±—É—é —Ü–µ–Ω—É –¥–ª—è –ø–ª–∞—Ç–µ–∂–∞.

**–†–µ—à–µ–Ω–∏–µ:**

- –î–æ–±–∞–≤–ª–µ–Ω `PriceValidationService` —Å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ —Ü–µ–Ω–∞–º–∏ –¥–ª—è —Ç–∏–ø–æ–≤ –ø–æ–¥–ø–∏—Å–æ–∫
- –°—Ç—Ä–æ–≥–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤ `CreatePaymentDto` —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏ min/max
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Ü–µ–Ω—ã —Ç–∏–ø—É –ø–æ–¥–ø–∏—Å–∫–∏

```typescript
// –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ü–µ–Ω—ã –≤ –∫–æ–ø–µ–π–∫–∞—Ö
MONTHLY: 150000,  // 1500 —Ä—É–±–ª–µ–π
YEARLY: 1500000,  // 15000 —Ä—É–±–ª–µ–π
ONE_TIME: 300000, // 3000 —Ä—É–±–ª–µ–π
```

### 2. –ö–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥–ª–∏ —Ä–∞–±–æ—Ç–∞—Ç—å —Å —á—É–∂–∏–º–∏ –ø–æ–¥–ø–∏—Å–∫–∞–º–∏ –∏ –ø–ª–∞—Ç–µ–∂–∞–º–∏.

**–†–µ—à–µ–Ω–∏–µ:**

- –í—Å–µ –º–µ—Ç–æ–¥—ã –ø—Ä–æ–≤–µ—Ä—è—é—Ç –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ —á–µ—Ä–µ–∑ `currentUserId`
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Ç–æ–ª—å–∫–æ —Å–æ —Å–≤–æ–∏–º–∏ –ø–æ–¥–ø–∏—Å–∫–∞–º–∏
- –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∑–∞—â–∏—â–µ–Ω—ã `AdminGuard`

### 3. –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

**–ü—Ä–æ–±–ª–µ–º–∞:** Race conditions –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø–æ–¥–ø–∏—Å–æ–∫.

**–†–µ—à–µ–Ω–∏–µ:**

- –í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –≤ database —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è—Ö
- –ê—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç—å —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–¥–ø–∏—Å–æ–∫ –∏ –ø–ª–∞—Ç–µ–∂–µ–π
- –ó–∞—â–∏—Ç–∞ –æ—Ç –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö –∑–∞–ø–∏—Å–µ–π

### 4. –ê—É–¥–∏—Ç —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

**–ü—Ä–æ–±–ª–µ–º–∞:** –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π.

**–†–µ—à–µ–Ω–∏–µ:**

- –ù–æ–≤–∞—è —Å—É—â–Ω–æ—Å—Ç—å `PaymentAudit` –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏–π
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–∏—è, –æ–ø–ª–∞—Ç—ã, –æ—Ç–º–µ–Ω—ã –ø–ª–∞—Ç–µ–∂–µ–π
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö: IP –∞–¥—Ä–µ—Å, User-Agent, –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏

### 5. –ó–∞—â–∏—Ç–∞ –æ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –ø–ª–∞—Ç–µ–∂–µ–π

**–ü—Ä–æ–±–ª–µ–º–∞:** –ú–æ–∂–Ω–æ –±—ã–ª–æ —Å–æ–∑–¥–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–ª–∞—Ç–µ–∂–µ–π –¥–ª—è –æ–¥–Ω–æ–π –ø–æ–¥–ø–∏—Å–∫–∏.

**–†–µ—à–µ–Ω–∏–µ:**

- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö PENDING –ø–ª–∞—Ç–µ–∂–µ–π –ø–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º –Ω–æ–≤—ã—Ö
- –û–¥–∏–Ω –∞–∫—Ç–∏–≤–Ω—ã–π –ø–ª–∞—Ç–µ–∂ –Ω–∞ –ø–æ–¥–ø–∏—Å–∫—É –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç –≤—Ä–µ–º–µ–Ω–∏

### 6. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å WebSocket

**–ü—Ä–æ–±–ª–µ–º–∞:** –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –≤ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è—Ö.

**–†–µ—à–µ–Ω–∏–µ:**

- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –∫ –ø–ª–∞—Ç–µ–∂—É –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –∫ –∫–æ–º–Ω–∞—Ç–µ
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –ø—Ä–∞–≤
- –í–∞–ª–∏–¥–∞—Ü–∏—è `userId` –¥–ª—è –≤—Å–µ—Ö WebSocket –æ–ø–µ—Ä–∞—Ü–∏–π

### 7. –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

**–ü—Ä–æ–±–ª–µ–º–∞:** –°–∏–º—É–ª—è—Ü–∏—è –ø–ª–∞—Ç–µ–∂–µ–π –¥–æ—Å—Ç—É–ø–Ω–∞ –≤—Å–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º.

**–†–µ—à–µ–Ω–∏–µ:**

- –°–∏–º—É–ª—è—Ü–∏—è –ø–ª–∞—Ç–µ–∂–µ–π —Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤
- `AdminGuard` —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π —Ä–æ–ª–µ–π —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

1. **SubscriptionService** - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∞–º–∏ —Å –∫–æ–Ω—Ç—Ä–æ–ª–µ–º –¥–æ—Å—Ç—É–ø–∞
2. **PaymentService** - –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–∞—Ç–µ–∂–µ–π
3. **PriceValidationService** - –í–∞–ª–∏–¥–∞—Ü–∏—è —Ü–µ–Ω –∏ —Ç–∏–ø–æ–≤ –ø–æ–¥–ø–∏—Å–æ–∫
4. **AuditService** - –ê—É–¥–∏—Ç –≤—Å–µ—Ö —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
5. **AdminGuard** - –ó–∞—â–∏—Ç–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤
6. **PaymentGateway** - –ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ WebSocket —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

### –ù–æ–≤—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏

1. **PaymentAudit** - –ñ—É—Ä–Ω–∞–ª –∞—É–¥–∏—Ç–∞ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
2. **PriceValidationService** - –°–µ—Ä–≤–∏—Å –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Ü–µ–Ω

## üìä –ü—Ä–æ—Ü–µ—Å—Å —Å–æ–∑–¥–∞–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–π –ø–æ–¥–ø–∏—Å–∫–∏

### 1. –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∏

```
POST /subscriptions
```

- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ (—Ç–æ–ª—å–∫–æ –¥–ª—è —Å–µ–±—è)
- –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–¥–ø–∏—Å–æ–∫
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–∏—è –≤ –∞—É–¥–∏—Ç

### 2. –°–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞

```
POST /subscriptions/payment/create
```

- –í–∞–ª–∏–¥–∞—Ü–∏—è —Ü–µ–Ω—ã –∏ —Ç–∏–ø–∞ –ø–æ–¥–ø–∏—Å–∫–∏
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –∫ –ø–æ–¥–ø–∏—Å–∫–µ
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π
- –°–æ–∑–¥–∞–Ω–∏–µ –≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ —Å –∞—É–¥–∏—Ç–æ–º

### 3. –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–∞—Ç–µ–∂–∞

```
POST /subscriptions/payment/callback
```

- –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–ª–∞—Ç–µ–∂–∞
- –ê—Ç–æ–º–∞—Ä–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤
- –ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ WebSocket —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- –ü–æ–ª–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–π

## üîê –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```env
# –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
ADMIN_USER_IDS=uuid1,uuid2,uuid3
ADMIN_EMAILS=admin@cleanhouse.com,superadmin@cleanhouse.com

# –ë–∞–∑–æ–≤—ã–π URL –¥–ª—è –ø–ª–∞—Ç–µ–∂–Ω—ã—Ö —Å—Å—ã–ª–æ–∫
BASE_URL=https://api.cleanhouse.com
```

### –õ–∏–º–∏—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

```typescript
// –õ–∏–º–∏—Ç—ã —Å—É–º–º –ø–ª–∞—Ç–µ–∂–µ–π
MIN_AMOUNT = 100; // 1 —Ä—É–±–ª—å
MAX_AMOUNT = 10000000; // 100000 —Ä—É–±–ª–µ–π

// –ò–Ω—Ç–µ—Ä–≤–∞–ª –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å–∞ –ø–ª–∞—Ç–µ–∂–∞
PAYMENT_CHECK_INTERVAL = 2000; // 2 —Å–µ–∫—É–Ω–¥—ã
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Ü–µ–Ω

```bash
# –¢–µ—Å—Ç –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ü–µ–Ω—ã
curl -X POST /subscriptions/payment/create \
  -H "Authorization: Bearer TOKEN" \
  -d '{"subscriptionId":"uuid","amount":1,"subscriptionType":"monthly"}'
# –û–∂–∏–¥–∞–µ—Ç—Å—è: 400 Bad Request —Å —Å–æ–æ–±—â–µ–Ω–∏–µ–º –æ –Ω–µ–≤–µ—Ä–Ω–æ–π —Å—É–º–º–µ
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ç—Ä–æ–ª—è –¥–æ—Å—Ç—É–ø–∞

```bash
# –¢–µ—Å—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ —á—É–∂–æ–π –ø–æ–¥–ø–∏—Å–∫–µ
curl -X POST /subscriptions/payment/create \
  -H "Authorization: Bearer USER_A_TOKEN" \
  -d '{"subscriptionId":"USER_B_SUBSCRIPTION","amount":150000,"subscriptionType":"monthly"}'
# –û–∂–∏–¥–∞–µ—Ç—Å—è: 403 Forbidden
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π

```bash
# –¢–µ—Å—Ç —Å–∏–º—É–ª—è—Ü–∏–∏ –æ—Ç –æ–±—ã—á–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
curl -X POST /subscriptions/payment/simulate/PAYMENT_ID \
  -H "Authorization: Bearer USER_TOKEN"
# –û–∂–∏–¥–∞–µ—Ç—Å—è: 403 Forbidden
```

## üìà –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞—É–¥–∏—Ç

### –ê—É–¥–∏—Ç –æ–ø–µ—Ä–∞—Ü–∏–π

–í—Å–µ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü–µ `payment_audit`:

```sql
SELECT
  action,
  userId,
  amount,
  metadata,
  ipAddress,
  createdAt
FROM payment_audit
WHERE userId = 'target-user-id'
ORDER BY createdAt DESC;
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

```sql
-- –ü–æ–∏—Å–∫ –ø–æ–ø—ã—Ç–æ–∫ –æ–±—Ö–æ–¥–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Ü–µ–Ω
SELECT * FROM payment_audit
WHERE metadata->>'oldAmount' != metadata->>'newAmount'
AND createdAt > NOW() - INTERVAL '24 hours';

-- –ü–æ–∏—Å–∫ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ –ø–ª–∞—Ç–µ–∂–µ–π
SELECT userId, COUNT(*) as failed_attempts
FROM payment_audit
WHERE action = 'payment_failed'
AND createdAt > NOW() - INTERVAL '1 hour'
GROUP BY userId
HAVING COUNT(*) > 5;
```

## üöÄ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

1. **–ò–Ω–¥–µ–∫—Å—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö** –Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø–æ–ª—è—Ö (paymentId, userId, createdAt)
2. **–ü—É–ª —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π** –¥–ª—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
3. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ü–µ–Ω –ø–æ–¥–ø–∏—Å–æ–∫
4. **–ë–∞—Ç—á–∏–Ω–≥** –∞—É–¥–∏—Ç –∑–∞–ø–∏—Å–µ–π –ø—Ä–∏ –≤—ã—Å–æ–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–µ

### –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

- –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã
- –û—Ç–¥–µ–ª—å–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞—É–¥–∏—Ç–∞
- Redis –¥–ª—è WebSocket —Å–æ—Å—Ç–æ—è–Ω–∏–π
- Queue –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–ª–∞—Ç–µ–∂–µ–π

## üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏ –º–∏–≥—Ä–∞—Ü–∏–∏

### –ú–∏–≥—Ä–∞—Ü–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö

1. –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ç–∞–±–ª–∏—Ü –∞—É–¥–∏—Ç–∞
2. –ü–µ—Ä–µ–Ω–æ—Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–ª–∞—Ç–µ–∂–µ–π —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π
3. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
4. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ staging –æ–∫—Ä—É–∂–µ–Ω–∏–∏

### –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

- –°—Ç–∞—Ä—ã–µ API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –ø–æ–º–µ—á–µ–Ω—ã –∫–∞–∫ deprecated
- –ì—Ä–∞–¥—É–∞–ª—å–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥ –∫–ª–∏–µ–Ω—Ç–æ–≤ –Ω–∞ –Ω–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º —Å —Å–∏—Å—Ç–µ–º–æ–π –ø–æ–¥–ø–∏—Å–æ–∫:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –∞—É–¥–∏—Ç–∞ –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º—ã
2. –£–±–µ–¥–∏—Ç–µ—Å—å –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–æ–≤ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∏ –∞—É–¥–∏—Ç–∞
4. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∫–æ–º–∞–Ω–¥–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ —Å –¥–µ—Ç–∞–ª—è–º–∏ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã –∞—É–¥–∏—Ç–∞

---

**–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:** –°–µ–Ω—Ç—è–±—Ä—å 2025  
**–í–µ—Ä—Å–∏—è:** 2.0.0  
**–°—Ç–∞—Ç—É—Å:** –ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Å –ø–æ–ª–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å—é
